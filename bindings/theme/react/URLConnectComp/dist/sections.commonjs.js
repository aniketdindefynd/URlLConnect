(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>c});var n={};e.r(n),e.d(n,{Component:()=>l,settings:()=>a});const r=require("fs");var o=e.n(r);function l({title:e="URLConnect Extension"}){const[t,n]=(0,r.useState)(""),[l,a]=(0,r.useState)(!0),[c,s]=(0,r.useState)(""),[i,u]=(0,r.useState)(!1),[m,d]=(0,r.useState)(!1),p=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=!1;return(async()=>{try{a(!0),s(""),u(!1),d(!1);const t=await fetch("/ext/urlconnect",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);if(!(t.headers.get("content-type")||"").includes("application/json")){const e=await t.text();throw console.log("Non-JSON response snippet:",e.slice(0,200)),new Error("Proxy returned HTML instead of JSON - proxy not configured correctly")}const r=await t.json();e||(r.url?(n(r.url),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{u(e=>!m||e)},15e3)):s("No URL configured"))}catch(t){e||s(t.message||"Failed to fetch stored URL")}finally{e||a(!1)}})(),()=>{e=!0,p.current&&(clearTimeout(p.current),p.current=null)}},[]);const f=t?`/ext/urlconnect/frame?url=${encodeURIComponent(t)}`:"";return l?o().createElement("div",{className:"urlconnect-component"},o().createElement("div",{className:"hero-loading"},o().createElement("div",{className:"loading-spinner"}),o().createElement("p",null,"Loading..."))):c?o().createElement("div",{className:"urlconnect-component"},o().createElement("div",{className:"hero-error"},o().createElement("h3",null,"âš ï¸ Error Loading Content"),o().createElement("p",null,c),o().createElement("button",{onClick:()=>window.location.reload(),className:"retry-button"},"ðŸ”„ Retry"))):t?i?o().createElement("div",{className:"urlconnect-component"},o().createElement("div",{className:"hero-blocked"},o().createElement("div",{className:"blocked-content"},o().createElement("h3",null,"ðŸ›¡ï¸ Preview Not Available"),o().createElement("p",null,"This website cannot be embedded. Open it directly:"),o().createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"hero-button"},"ðŸ”— Open ",(()=>{try{return new URL(t).hostname}catch{return"Website"}})())))):o().createElement("div",{className:"urlconnect-component"},o().createElement("div",{className:"hero-iframe-container"},o().createElement("iframe",{src:f,className:"hero-iframe",title:"URLConnect Preview",style:{border:"none"},sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",referrerPolicy:"no-referrer",onLoad:()=>{d(!0),u(!1),p.current&&(clearTimeout(p.current),p.current=null)},onError:()=>{d(!1),u(!0),p.current&&(clearTimeout(p.current),p.current=null)}}),!m&&o().createElement("div",{className:"hero-loading-overlay"},o().createElement("div",{className:"loading-spinner"}),o().createElement("p",null,"Loading preview...")))):o().createElement("div",{className:"urlconnect-component"},o().createElement("div",{className:"hero-no-url"},o().createElement("h3",null,"ðŸ”— No URL Configured"),o().createElement("p",null,"Please configure a URL through the URLConnect extension.")))}const a={label:"URLConnect Display",name:"urlconnect-display",props:[{id:"title",label:"Page Title",type:"text",default:"URLConnect Extension"}],blocks:[]},c={"urlconnect-display":{...n}};exports.sections=t})();